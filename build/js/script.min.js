"use strict";function _asyncToGenerator(n){return function(){var t=n.apply(this,arguments);return new Promise(function(n,e){function o(r,u){try{var i=t[r](u),d=i.value}catch(n){return void e(n)}if(!i.done)return Promise.resolve(d).then(function(n){o("next",n)},function(n){o("throw",n)});n(d)}return o("next")})}}var numSocket=new D3NE.Socket("number","Number value","hint"),strSocket=new D3NE.Socket("string","String","hint"),componentTop=new D3NE.Component("Top",{builder:function(n){var t=new D3NE.Output("Position Top (max 160)",numSocket),e=new D3NE.Control('<input type="number">',function(n,t){function e(){t.putData("num",parseFloat(n.value))}n.value=t.getData("num")||80,n.addEventListener("input",function(){e(),editor.eventListener.trigger("change")}),n.addEventListener("mousedown",function(n){n.stopPropagation()}),e()});return n.addControl(e).addOutput(t)},worker:function(n,t,e){e[0]=n.data.num}}),componentLeft=new D3NE.Component("Left",{builder:function(n){var t=new D3NE.Output("Position Left (max 420)",numSocket),e=new D3NE.Control('<input type="number">',function(n,t){function e(){t.putData("num",parseFloat(n.value))}n.value=t.getData("num")||210,n.addEventListener("input",function(){e(),editor.eventListener.trigger("change")}),n.addEventListener("mousedown",function(n){n.stopPropagation()}),e()});return n.addControl(e).addOutput(t)},worker:function(n,t,e){e[0]=n.data.num}}),componentColor=new D3NE.Component("Color",{builder:function(n){var t=new D3NE.Output("Color",strSocket),e=new D3NE.Control('<input type="color">',function(n,t){function e(){t.putData("color",n.value)}n.value=t.getData("color")||"#00d2ff",n.addEventListener("input",function(){e(),editor.eventListener.trigger("change")}),n.addEventListener("mousedown",function(n){n.stopPropagation()}),e()});return n.addControl(e).addOutput(t)},worker:function(n,t,e){e[0]=n.data.color}}),componentButton=new D3NE.Component("Button",{builder:function(n){var t=new D3NE.Input("Position Top",numSocket),e=new D3NE.Input("Position Left",numSocket),o=new D3NE.Input("Color",strSocket),r=new D3NE.Control('<input readonly type="number">',function(n,t){t.setValue=function(t){n.value=t}}),u=new D3NE.Control('<input readonly type="number">',function(n,t){t.setValue=function(t){n.value=t}}),i=new D3NE.Control('<input readonly type="color">',function(n,t){t.setValue=function(t){n.value=t}});return n.addInput(t).addInput(e).addInput(o).addControl(r).addControl(u).addControl(i)},worker:function(n,t,e){var o=document.getElementById("my-button");t[0][0]<=160&&t[0][0]>=0?o.style.top=t[0][0]+"px":t[0][0]>160?o.style.top="160px":o.style.top="0px",t[1][0]<=420&&t[1][0]>=0?o.style.left=t[1][0]+"px":t[1][0]>420?o.style.left="420px":o.style.left="0px",o.style.backgroundColor=t[2][0]+"",editor.nodes.find(function(t){return t.id==n.id}).controls[0].setValue(t[0][0]),editor.nodes.find(function(t){return t.id==n.id}).controls[1].setValue(t[1][0]),editor.nodes.find(function(t){return t.id==n.id}).controls[2].setValue(t[2][0])}}),menu=new D3NE.ContextMenu({Values:{Value:componentTop,Action:function(){alert("ok")}},Button:componentButton}),container=document.getElementById("nodeEditor"),components=[componentTop,componentLeft,componentColor,componentButton],editor=new D3NE.NodeEditor("demo@0.1.0",container,components,menu),n1=componentTop.builder(componentTop.newNode()),n2=componentLeft.builder(componentLeft.newNode()),n3=componentColor.builder(componentColor.newNode()),button=componentButton.builder(componentButton.newNode());n1.position=[40,50],n2.position=[40,250],n3.position=[40,450],button.position=[400,130],editor.connect(n1.outputs[0],button.inputs[0]),editor.connect(n2.outputs[0],button.inputs[1]),editor.connect(n3.outputs[0],button.inputs[2]),editor.addNode(n1),editor.addNode(n2),editor.addNode(n3),editor.addNode(button);var engine=new D3NE.Engine("demo@0.1.0",components);editor.eventListener.on("change",_asyncToGenerator(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,engine.abort();case 2:return n.next=4,engine.process(editor.toJSON());case 4:case"end":return n.stop()}},n,this)}))),editor.view.zoomAt(editor.nodes),editor.eventListener.trigger("change"),editor.view.resize();